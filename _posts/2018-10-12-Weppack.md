---
layout: post
title: 读书笔记—Vue.js权威指南（十五）
tags: [前端技术]
---
#### 遇见Vue.js

* 关键词：Vue.js -- 读书笔记

### 二十二、Webpack

#### 基本概念

Webpack是一个模块化加载器，它同时支持AMD、CMD等加载规范。与其他模块化加载器相比，它具有以下优势：

1.代码分割

同步和异步，同步的依赖会在编译时直接打包输出到目的文件中；异步的依赖会单独生成一个代码块，只有在浏览器中运行需要的时候才会异步加载该代码块。

2.Loaders

在默认情况下，Webpack只处理js文件，但是通过加载器我们可以将其他类型的资源转换为js输出。

3.插件机制

Webpack提供了强大的插件系统，当Webpack内置的功能不能满足我们的构建需求时，我们可以通过使用插件来提高工作效率。

#### 安装

全局安装：npm i webpack -g

作为依赖在项目中进行安装：

npm init

npm -i webpack --save-dev

#### 基本使用

> 打包实例

```javascript
    example
        |-app.js
        |-cats.js
    //cats.js
    var cats = ['dave', 'henry', 'martha'];
    module.exports = cats;
    //app.js
    cats = require('./cats.js');
    console.log(cats);
    //通过webpack命令指定要打包的入口文件app.js和最终输出文件app.bundle.js来打包应用
    webpack ./app.js app.bundle.js
    //我们在node环境中进行了演示，实际上webpack打包后的代码可以运行在任何环境中，包括浏览器环境
```

![image]({{ site.baseurl }}/assets/img/blog/2018-10-12-Webpack/1.png)

#### 命令行

webpack命令进行简单打包，语法如下：

webpack<entry><output>

> 常用参数

entry为要打包的入口文件路径，output为打包后的文件路径。

-p：对打包后的代码进行压缩

--watch：文件发生变化时，重新打包

--config：指定webpack打包配置文件，稍后会详细介绍配置文件

--progress：在终端显示打包过程

#### 配置文件

通过webpack命令行传参，我们可以进行简单的打包构建。对于复杂的打包，我们可以在项目的根目录下提供一个配置文件，在配置文件中对打包过程进行更详细的配置。在项目根目录下不提供参数直接调用webpack命令：

webpack

webpack默认会调用项目根目录下的webpack.config.js文件，我们也可以通过-config参数指定配置文件，执行如下命令：

webpack -config webpack.config.build.js

配置文件的内容需要通过module.exports进行导出：

//webpack.config.js

module.exports = { //配置选项 }

> webpack中包含的配置选项

![image]({{ site.baseurl }}/assets/img/blog/2018-10-12-Webpack/2.png)

1.context，配置基础路径(必须为绝对路径)，默认为process.cwd()，即运行webpack命令的目录。

2.entry，配置要打包的入口文件，值可以是字符串、数组、对象。该选项指定的路径会相对context选项指定的路径进行查找。

```javascript
    //1.字符串
    直接指定路径，该路径相对于context选项
    entry: "./entry"
    //2.数组
    路径数组，webpack会按序打包，但是只导出最后一个文件
    entry: ["./entry1", "./entry2"]
    //3.对象
    当entry值为对象时，键名为块名，可以随意指定，键值可以为字符串或数组类型。该块名可以在output选项中使用，代码示例：
    {
        entry: {
            page1: "./page1",
            page2: ["./entry1", "./entry2"]
        },
        output: {
            //打包后输出文件名，name为entry中对应的键名
            filename: "[name].bundle.js"
        }
    }
    以上选项配置后，运行命令在项目根目录下回生成page1.bundle.js和page2.bundle.js文件
```

3.output，配置输出信息。

配置打包后的文件名，注意值不是绝对路径。我们应该通过output.path来指定输出路径，filename会相对output.path来输出。

```javascipt
    //单入口示例
    {
        entry: './src/app.js',
        output: {
            filename: 'bundle.js',
            path: _dirname + '/build'
        }
    }
    //写入磁盘路径为：./build/bundle.js
```

如果项目有多个入口，对于每个入口打包后的文件名我们需要保证其唯一性。webpack提供了一下模式来动态生成输出文件名：

/[name/],入口文件块名

/[hash/],每个入口打包后的hash值

/[chunkhash/],在使用代码分割时，异步加载的文件的hash值

```javascipt
    //多入口示例
    {
        entry: {
            app: './src/app.js',
            search: './src/search.js'
        },
        output: {
            filename: '[name].js',
            //filename: '[hash].js',
            //filename: '[chunkhash].js',
            path: _dirname + '/build'
        }
    }
    //写入磁盘路径为：./build/app.js、./build/search.js
```

4.output.path——打包后的文件的根目录（绝对路径）。

module，用来进行模块加载相关配置。
















